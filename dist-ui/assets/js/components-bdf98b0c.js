import{r as L,a1 as E,t as O,a2 as T,a3 as P}from"./index-411664c1.js";import{c as o,t as h}from"./index-6bf0d9f6.js";import{n as q}from"./util-006b265b.js";const B=()=>{const t=L(""),e=E();t.value=e.meta.key;const r=O(()=>T().authButtonsObj[t.value]||{});return{nowKey:t,BUTTONS:r}};var C={};(function(t){var e=P&&P.__assign||function(){return(e=Object.assign||function(l){for(var n,i=1,a=arguments.length;i<a;i++)for(var p in n=arguments[i])Object.prototype.hasOwnProperty.call(n,p)&&(l[p]=n[p]);return l}).apply(this,arguments)},r=(Object.defineProperty(t,"__esModule",{value:!0}),{id:"id",parentId:"parentId",dataField:"data",childrenField:"children",throwIfOrphans:!1,rootParentIds:{"":!(t.countNodes=t.arrayToTree=void 0)},nestedIds:!0,assign:!1});function s(l,n){n===void 0&&(n={});for(var i,a=e(e({},r),n),p=[],u={},y=a.throwIfOrphans?new Set:null,w=0,I=l;w<I.length;w++){var f=I[w],g=a.nestedIds?d(f,a.id):f[a.id],m=a.nestedIds?d(f,a.parentId):f[a.parentId];if(a.rootParentIds[g])throw new Error("The item array contains a node whose parentId both exists in another node and is in "+'`rootParentIds` (`itemId`: "'.concat(g,'", `rootParentIds`: ').concat(Object.keys(a.rootParentIds).map(function(F){return'"'.concat(F,'"')}).join(", "),")."));Object.prototype.hasOwnProperty.call(u,g)||(u[g]=((i={})[a.childrenField]=[],i)),y&&y.delete(g),a.dataField?u[g][a.dataField]=f:a.assign?u[g]=Object.assign(f,((i={})[a.childrenField]=u[g][a.childrenField],i)):u[g]=e(e({},f),((f={})[a.childrenField]=u[g][a.childrenField],f)),f=u[g],m==null||a.rootParentIds[m]?p.push(f):(Object.prototype.hasOwnProperty.call(u,m)||(u[m]=((g={})[a.childrenField]=[],g),y&&y.add(m)),u[m][a.childrenField].push(f))}if(y!=null&&y.size)throw new Error("The items array contains orphans that point to the following parentIds: "+"[".concat(Array.from(y),"]. These parentIds do not exist in the items array. Hint: prevent orphans to result ")+"in an error by passing the following option: { throwIfOrphans: false }");if(a.throwIfOrphans&&c(p,a.childrenField)<Object.keys(u).length)throw new Error("The items array contains nodes with a circular parent/child relationship.");return p}function c(l,n){return l.reduce(function(i,a){return i+1+(a[n]&&c(a[n],n))},0)}function d(l,n){return n.split(".").reduce(function(i,a){return i&&i[a]},l)}t.arrayToTree=s,t.countNodes=c})(C);const j=t=>{let e=Object.keys(t),r=[];for(const c of e)if(typeof t[c]=="object"){let d=[];Object.keys(t[c]).forEach(l=>{d.push(`${c}~'${t[c][l]}'`)}),d.length>0&&r.push(`(${d.join(" || ")})`)}else r.push(`${c}~'${t[c]}'`);return r.join(" && ")},_=(t,e,r="id",s="parent",c=[])=>{const d=t.find(n=>n[r]===e);c.push(d.name);const l=t.find(n=>n[r]===d[s]);return l?_(t,l[r],r,s,c):c.reverse().join(" > ")},x=async t=>{var r,s;return{data:await o.records.getList("components",t.page,t.perPage,{filter:j(t.filter),sort:(r=t.sort)!=null?r:"",expand:(s=t.expand)!=null?s:""})}},z=async t=>(await x({page:1,perPage:999,filter:t.filter,expand:"",sort:""})).data.items,b=async t=>({data:await o.records.create("components",t)}),G=async t=>({data:await o.records.update("components",t.id,t)}),H=async t=>{for(const e of t.ids)await o.records.delete("components",e);return!0},K=async()=>{let[t,e]=await h(()=>o.records.getList("components",1,99999,{$autoCancel:!1}));return{data:t.items}},M=async t=>{for(let e of t.getAll("file")){let r=e;if(r.type==="text/csv"){let c=(await r.text()).split(`
`);for(let d=1;d<c.length;d++){let n=c[d].split(/,(?=(?:(?:[^"]*"){2})*[^"]*$)/);n=n||[];let i={category:"",manufacturer:n[1],mpn:n[2],description:n[3],stock:Number(n[4]),ipn:"",storage_location:"",comment:"",footprint:"",specs:[]};if(!i.mpn)continue;let p=(await S()).data.find(w=>w.name===n[6]);i.storage_location=p?p.id:(await $({name:n[6],description:"",category:""})).data.id;let y=(await v()).data.find(w=>w.name===n[0]);i.category=y?y.id:(await U({name:n[0],description:"",parent:""})).data.id,await b(i)}}}},U=async t=>({data:await o.records.create("component_categories",t)}),J=async t=>({data:await o.records.update("component_categories",t.id,t)}),Q=async t=>{for(const e of t.ids)await o.records.delete("component_categories",e);return!0},v=async()=>{let[t,e]=await h(()=>o.records.getList("component_categories",1,99999,{$autoCancel:!1}));return t.items.forEach(r=>{r._fullName=_(t.items,r.id)}),{data:t.items}},V=async()=>{let[t,e]=await h(()=>o.records.getList("component_categories",1,99999,{$autoCancel:!1}));return{data:C.arrayToTree(t.items,{id:"id",parentId:"parent",dataField:null})}},R=async t=>{var r,s;return{data:await o.records.getList("footprints",t.page,t.perPage,{filter:j(t.filter),sort:(r=t.sort)!=null?r:"",expand:(s=t.expand)!=null?s:""})}},W=async()=>({data:(await o.records.getList("footprints",1,99999,{})).items}),X=async t=>({data:await o.records.create("footprints",t)}),Y=async t=>({data:await o.records.update("footprints",t.id,t)}),Z=async t=>{for(const e of t.ids)await o.records.delete("footprints",e);return!0},tt=async t=>({data:await o.records.create("footprint_categories",t)}),et=async t=>({data:await o.records.update("footprint_categories",t.id,t)}),rt=async t=>{for(const e of t.ids)await o.records.delete("footprint_categories",e);return!0},ot=async()=>{let[t,e]=await h(()=>o.records.getList("footprint_categories",1,99999,{$autoCancel:!1}));return e?!1:(t.items.forEach(r=>{r._fullName=_(t.items,r.id)}),{data:t.items})},at=async()=>{let[t,e]=await h(()=>o.records.getList("footprint_categories",1,99999,{$autoCancel:!1}));return e?!1:{data:C.arrayToTree(t.items,{id:"id",parentId:"parent",dataField:null})}},S=async()=>({data:(await o.records.getList("storage_locations",1,99999,{})).items}),nt=async t=>{var r,s;return{data:await o.records.getList("storage_locations",t.page,t.perPage,{filter:j(t.filter),sort:(r=t.sort)!=null?r:"",expand:(s=t.expand)!=null?s:""})}},$=async t=>({data:await o.records.create("storage_locations",t)}),st=async t=>({data:await o.records.update("storage_locations",t.id,t)}),ct=async t=>{for(const e of t.ids)await o.records.delete("storage_locations",e);return!0},it=async t=>({data:await o.records.create("storage_categories",t)}),dt=async t=>({data:await o.records.update("storage_categories",t.id,t)}),lt=async t=>{for(const e of t.ids)await o.records.delete("storage_categories",e);return!0},ut=async()=>{let[t,e]=await h(()=>o.records.getList("storage_categories",1,99999,{$autoCancel:!1}));return e?!1:(t.items.forEach(r=>{r._fullName=_(t.items,r.id)}),{data:t.items})},pt=async()=>{let[t,e]=await h(()=>o.records.getList("storage_categories",1,99999,{$autoCancel:!1}));return e?!1:{data:C.arrayToTree(t.items,{id:"id",parentId:"parent",dataField:null})}},gt=async()=>({data:(await o.records.getList("projects",1,99999,{})).items}),ft=async t=>({data:await o.records.create("projects",t)}),yt=async t=>({data:await o.records.update("projects",t.id,t)}),wt=async t=>{for(const e of t.ids)await o.records.delete("projects",e);return!0},D=async t=>{var d,l;if(t.projectID==="")return{data:{}};let e=await o.records.getOne("projects",t.projectID,{});if(typeof e.quantity!="object"||e.quantity===null||e.quantity.length===0)return{data:{}};let r={id:{...e.quantity.map(n=>n.id)}},s=t.filter;q(s,r);let c=await o.records.getList("components",1,99999,{filter:j(r),sort:(d=t.sort)!=null?d:"",expand:(l=t.expand)!=null?l:""});return await c.items.forEach(function(n,i,a){var p;a[i]._quantityUsed=Number((p=e.quantity.find(u=>u.id===n.id))==null?void 0:p.quantity),a[i]._ofProjectID=e.id}),{data:c}},ht=async t=>{var r;return(await D({page:1,perPage:999,filter:t.filter,expand:"",sort:"",projectID:(r=t.projectID)!=null?r:""})).data.items},mt=async t=>{var s;let e=await o.records.getOne("projects",t._ofProjectID,{});return typeof e.quantity=="object"&&e.quantity!==null&&Array.isArray(e.quantity)?((s=e.quantity)==null?void 0:s.findIndex(d=>d.id==t.id))===-1&&e.quantity.push({id:t.id,quantity:t._quantityUsed}):e.quantity=[{id:t.id,quantity:t._quantityUsed}],{data:await o.records.update("projects",t._ofProjectID,e)}},jt=async t=>{let e=await o.records.getOne("projects",t._ofProjectID,{});return e.quantity[e.quantity.findIndex(s=>s.id==t.id)]={id:t.id,quantity:t._quantityUsed},{data:await o.records.update("projects",t._ofProjectID,e)}},Ct=async t=>{let e=await o.records.getOne("projects",t.projectID,{});for(const s of t.ids){let c=e.quantity.findIndex(d=>d.id==s);c!==-1&&e.quantity.splice(c,1)}return{data:await o.records.update("projects",t.projectID,e)}},_t=async t=>{var r,s;return{data:await o.records.getList("profiles",t.page,t.perPage,{filter:j(t.filter),sort:(r=t.sort)!=null?r:"",expand:(s=t.expand)!=null?s:""})}},It=async t=>({data:await o.records.create("profiles",t)}),Pt=async t=>({data:await o.records.update("profiles",t.id,t)}),Ft=async t=>{for(const e of t.ids)await o.records.delete("profiles",e);return!0},Lt=async t=>{let r=(await o.records.getList("config")).items.find(s=>s.category===t.category);return{data:r==null?void 0:r.value}},Et=async t=>{let r=(await o.records.getList("config")).items.find(c=>c.category===t.category);return r?{data:await o.records.update("config",r==null?void 0:r.id,t)}:void 0};export{K as A,gt as B,D as C,Ct as D,ht as E,mt as F,jt as G,ft as H,yt as I,wt as J,Lt as K,Et as L,nt as M,ut as N,st as O,dt as P,ct as Q,lt as R,_t as S,It as T,Pt as U,Ft as V,x as a,v as b,G as c,U as d,J as e,H as f,V as g,Q as h,S as i,W as j,X as k,$ as l,at as m,tt as n,pt as o,b as p,it as q,R as r,ot as s,Y as t,B as u,et as v,Z as w,rt as x,z as y,M as z};
