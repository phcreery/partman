import{A as J,G as z,E as k,z as B}from"./index-411664c1.js";let U;const K=()=>{U=J.service({fullscreen:!0,lock:!0,text:"Loading",background:"rgba(0, 0, 0, 0.7)"})},H=()=>{U.close()};let S=0;const $=()=>{S===0&&K(),S++},Q=()=>{S<=0||(S--,S===0&&H())};var O=(i=>(i[i.SUCCESS=200]="SUCCESS",i[i.BADREQ=400]="BADREQ",i[i.FORBIDDEN=403]="FORBIDDEN",i[i.ERROR=500]="ERROR",i[i.OVERDUE=599]="OVERDUE",i[i.TIMEOUT=1e4]="TIMEOUT",i.TYPE="success",i))(O||{}),T=function(i,n){return T=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])},T(i,n)};function h(i,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function t(){this.constructor=i}T(i,n),i.prototype=n===null?Object.create(n):(t.prototype=n.prototype,new t)}var _=function(){return _=Object.assign||function(i){for(var n,t=1,e=arguments.length;t<e;t++)for(var o in n=arguments[t])Object.prototype.hasOwnProperty.call(n,o)&&(i[o]=n[o]);return i},_.apply(this,arguments)};function y(i,n,t,e){return new(t||(t=Promise))(function(o,r){function s(d){try{l(e.next(d))}catch(u){r(u)}}function a(d){try{l(e.throw(d))}catch(u){r(u)}}function l(d){var u;d.done?o(d.value):(u=d.value,u instanceof t?u:new t(function(p){p(u)})).then(s,a)}l((e=e.apply(i,n||[])).next())})}function b(i,n){var t,e,o,r,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(r[Symbol.iterator]=function(){return this}),r;function a(l){return function(d){return function(u){if(t)throw new TypeError("Generator is already executing.");for(;s;)try{if(t=1,e&&(o=2&u[0]?e.return:u[0]?e.throw||((o=e.return)&&o.call(e),0):e.next)&&!(o=o.call(e,u[1])).done)return o;switch(e=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return s.label++,{value:u[1],done:!1};case 5:s.label++,e=u[1],u=[0];continue;case 7:u=s.ops.pop(),s.trys.pop();continue;default:if(o=s.trys,!((o=o.length>0&&o[o.length-1])||u[0]!==6&&u[0]!==2)){s=0;continue}if(u[0]===3&&(!o||u[1]>o[0]&&u[1]<o[3])){s.label=u[1];break}if(u[0]===6&&s.label<o[1]){s.label=o[1],o=u;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(u);break}o[2]&&s.ops.pop(),s.trys.pop();continue}u=n.call(i,s)}catch(p){u=[6,p],e=0}finally{t=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([l,d])}}}var q,E=function(i){function n(t){var e,o=this;return(o=i.call(this,"ClientResponseError")||this).url="",o.status=0,o.data={},o.isAbort=!1,o.originalError=null,t instanceof Error&&!(t instanceof o.constructor)&&(o.originalError=t),t!==null&&typeof t=="object"&&(o.url=typeof t.url=="string"?t.url:"",o.status=typeof t.status=="number"?t.status:0,o.data=t.data!==null&&typeof t.data=="object"?t.data:{}),typeof DOMException!="undefined"&&t instanceof DOMException&&(o.isAbort=!0),o.name="ClientResponseError "+o.status,o.message=((e=o.data)===null||e===void 0?void 0:e.message)||"Something went wrong while processing your request.",o}return h(n,i),n.prototype.toJSON=function(){return _({},this)},n}(Error);q=typeof atob=="function"?atob:function(i){return Buffer.from(i,"base64").toString("binary")};var W=function(){function i(){}return i.getPayload=function(n){if(n)try{var t=decodeURIComponent(q(n.split(".")[1]).split("").map(function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)}).join(""));return JSON.parse(t)||{}}catch{}return{}},i.isExpired=function(n,t){t===void 0&&(t=0);var e=i.getPayload(n);return!(Object.keys(e).length>0&&(!e.exp||e.exp-t>Date.now()/1e3))},i}(),Y=function(){function i(){this.baseToken="",this.baseModel={},this._onChangeCallbacks=[]}return Object.defineProperty(i.prototype,"token",{get:function(){return this.baseToken},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"model",{get:function(){return this.baseModel},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"isValid",{get:function(){return!W.isExpired(this.token)},enumerable:!1,configurable:!0}),i.prototype.save=function(n,t){this.baseToken=n,this.baseModel=t,this.triggerChange()},i.prototype.clear=function(){this.baseToken="",this.baseModel={},this.triggerChange()},i.prototype.onChange=function(n){var t=this;return this._onChangeCallbacks.push(n),function(){for(var e=t._onChangeCallbacks.length-1;e>=0;e--)if(t._onChangeCallbacks[e]==n)return delete t._onChangeCallbacks[e],void t._onChangeCallbacks.splice(e,1)}},i.prototype.triggerChange=function(){for(var n=0,t=this._onChangeCallbacks;n<t.length;n++){var e=t[n];e&&e(this.token,this.model)}},i}(),C=function(){function i(n){n===void 0&&(n={}),this.load(n||{})}return i.prototype.load=function(n){this.id=n.id!==void 0?n.id:"",this.created=n.created!==void 0?n.created:"",this.updated=n.updated!==void 0?n.updated:""},Object.defineProperty(i.prototype,"isNew",{get:function(){return!this.id||this.id==="00000000-0000-0000-0000-000000000000"},enumerable:!1,configurable:!0}),i.prototype.clone=function(){return new this.constructor(JSON.parse(JSON.stringify(this)))},i.prototype.export=function(){return Object.assign({},this)},i}(),x=function(i){function n(){return i!==null&&i.apply(this,arguments)||this}return h(n,i),n.prototype.load=function(t){i.prototype.load.call(this,t);for(var e=0,o=Object.entries(t);e<o.length;e++){var r=o[e],s=r[0],a=r[1];this[s]=a}this["@collectionId"]=t["@collectionId"]!==void 0?t["@collectionId"]:"",this["@collectionName"]=t["@collectionName"]!==void 0?t["@collectionName"]:"",this["@expand"]=t["@expand"]!==void 0?t["@expand"]:{}},n}(C),N=function(i){function n(){return i!==null&&i.apply(this,arguments)||this}return h(n,i),n.prototype.load=function(t){i.prototype.load.call(this,t),this.email=typeof t.email=="string"?t.email:"",this.verified=!!t.verified,this.lastResetSentAt=typeof t.lastResetSentAt=="string"?t.lastResetSentAt:"",this.lastVerificationSentAt=typeof t.lastVerificationSentAt=="string"?t.lastVerificationSentAt:"",this.profile=t.profile?new x(t.profile):null},n}(C),G=function(i){function n(){return i!==null&&i.apply(this,arguments)||this}return h(n,i),n.prototype.load=function(t){i.prototype.load.call(this,t),this.avatar=typeof t.avatar=="number"?t.avatar:0,this.email=typeof t.email=="string"?t.email:"",this.lastResetSentAt=typeof t.lastResetSentAt=="string"?t.lastResetSentAt:""},n}(C),X=function(i){function n(t){t===void 0&&(t="pocketbase_auth");var e=i.call(this)||this;return e.fallback={},e.storageKey=t,e}return h(n,i),Object.defineProperty(n.prototype,"token",{get:function(){return(this._storageGet(this.storageKey)||{}).token||""},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"model",{get:function(){var t,e=this._storageGet(this.storageKey)||{};return e===null||typeof e!="object"||e.model===null||typeof e.model!="object"?{}:((t=e.model)===null||t===void 0?void 0:t.verified)!==void 0?new N(e.model):new G(e.model)},enumerable:!1,configurable:!0}),n.prototype.save=function(t,e){this._storageSet(this.storageKey,{token:t,model:e}),i.prototype.save.call(this,t,e)},n.prototype.clear=function(){this._storageRemove(this.storageKey),i.prototype.clear.call(this)},n.prototype._storageGet=function(t){var e;if(typeof window!="undefined"&&(window==null?void 0:window.localStorage)){var o=((e=window==null?void 0:window.localStorage)===null||e===void 0?void 0:e.getItem(t))||"";try{return JSON.parse(o)}catch{return o}}return this.fallback[t]},n.prototype._storageSet=function(t,e){var o;if(typeof window!="undefined"&&(window==null?void 0:window.localStorage)){var r=e;typeof e!="string"&&(r=JSON.stringify(e)),(o=window==null?void 0:window.localStorage)===null||o===void 0||o.setItem(t,r)}else this.fallback[t]=e},n.prototype._storageRemove=function(t){var e;typeof window!="undefined"&&((e=window==null?void 0:window.localStorage)===null||e===void 0||e.removeItem(t)),delete this.fallback[t]},n}(Y),P=function(i){this.client=i},Z=function(i){function n(){return i!==null&&i.apply(this,arguments)||this}return h(n,i),n.prototype.getAll=function(t){return t===void 0&&(t={}),this.client.send("/api/settings",{method:"GET",params:t}).then(function(e){return e||{}})},n.prototype.update=function(t,e){return t===void 0&&(t={}),e===void 0&&(e={}),this.client.send("/api/settings",{method:"PATCH",params:e,body:t}).then(function(o){return o||{}})},n}(P),D=function(i,n,t,e){this.page=i>0?i:1,this.perPage=n>=0?n:0,this.totalItems=t>=0?t:0,this.items=e||[]},V=function(i){function n(){return i!==null&&i.apply(this,arguments)||this}return h(n,i),n.prototype._getFullList=function(t,e,o){var r=this;e===void 0&&(e=100),o===void 0&&(o={});var s=[],a=function(l){return y(r,void 0,void 0,function(){return b(this,function(d){return[2,this._getList(t,l,e,o).then(function(u){var p=u,c=p.items,g=p.totalItems;return s=s.concat(c),c.length&&g>s.length?a(l+1):s})]})})};return a(1)},n.prototype._getList=function(t,e,o,r){var s=this;return e===void 0&&(e=1),o===void 0&&(o=30),r===void 0&&(r={}),r=Object.assign({page:e,perPage:o},r),this.client.send(t,{method:"GET",params:r}).then(function(a){var l=[];if(a!=null&&a.items){a.items=a.items||[];for(var d=0,u=a.items;d<u.length;d++){var p=u[d];l.push(s.decode(p))}}return new D((a==null?void 0:a.page)||1,(a==null?void 0:a.perPage)||0,(a==null?void 0:a.totalItems)||0,l)})},n.prototype._getOne=function(t,e,o){var r=this;return o===void 0&&(o={}),this.client.send(t+"/"+encodeURIComponent(e),{method:"GET",params:o}).then(function(s){return r.decode(s)})},n.prototype._create=function(t,e,o){var r=this;return e===void 0&&(e={}),o===void 0&&(o={}),this.client.send(t,{method:"POST",params:o,body:e}).then(function(s){return r.decode(s)})},n.prototype._update=function(t,e,o,r){var s=this;return o===void 0&&(o={}),r===void 0&&(r={}),this.client.send(t+"/"+encodeURIComponent(e),{method:"PATCH",params:r,body:o}).then(function(a){return s.decode(a)})},n.prototype._delete=function(t,e,o,r){return o===void 0&&(o={}),r===void 0&&(r={}),this.client.send(t+"/"+encodeURIComponent(e),{method:"DELETE",params:r,body:o}).then(function(){return!0})},n}(P),A=function(i){function n(){return i!==null&&i.apply(this,arguments)||this}return h(n,i),n.prototype.getFullList=function(t,e){return t===void 0&&(t=100),e===void 0&&(e={}),this._getFullList(this.baseCrudPath(),t,e)},n.prototype.getList=function(t,e,o){return t===void 0&&(t=1),e===void 0&&(e=30),o===void 0&&(o={}),this._getList(this.baseCrudPath(),t,e,o)},n.prototype.getOne=function(t,e){return e===void 0&&(e={}),this._getOne(this.baseCrudPath(),t,e)},n.prototype.create=function(t,e){return t===void 0&&(t={}),e===void 0&&(e={}),this._create(this.baseCrudPath(),t,e)},n.prototype.update=function(t,e,o){return e===void 0&&(e={}),o===void 0&&(o={}),this._update(this.baseCrudPath(),t,e,o)},n.prototype.delete=function(t,e,o){return e===void 0&&(e={}),o===void 0&&(o={}),this._delete(this.baseCrudPath(),t,e,o)},n}(V),tt=function(i){function n(){return i!==null&&i.apply(this,arguments)||this}return h(n,i),n.prototype.decode=function(t){return new G(t)},n.prototype.baseCrudPath=function(){return"/api/admins"},n.prototype.authResponse=function(t){var e=this.decode((t==null?void 0:t.admin)||{});return(t==null?void 0:t.token)&&(t==null?void 0:t.admin)&&this.client.authStore.save(t.token,e),Object.assign({},t,{token:(t==null?void 0:t.token)||"",admin:e})},n.prototype.authViaEmail=function(t,e,o,r){return o===void 0&&(o={}),r===void 0&&(r={}),o=Object.assign({email:t,password:e},o),this.client.send(this.baseCrudPath()+"/auth-via-email",{method:"POST",params:r,body:o,headers:{Authorization:""}}).then(this.authResponse.bind(this))},n.prototype.refresh=function(t,e){return t===void 0&&(t={}),e===void 0&&(e={}),this.client.send(this.baseCrudPath()+"/refresh",{method:"POST",params:e,body:t}).then(this.authResponse.bind(this))},n.prototype.requestPasswordReset=function(t,e,o){return e===void 0&&(e={}),o===void 0&&(o={}),e=Object.assign({email:t},e),this.client.send(this.baseCrudPath()+"/request-password-reset",{method:"POST",params:o,body:e}).then(function(){return!0})},n.prototype.confirmPasswordReset=function(t,e,o,r,s){return r===void 0&&(r={}),s===void 0&&(s={}),r=Object.assign({token:t,password:e,passwordConfirm:o},r),this.client.send(this.baseCrudPath()+"/confirm-password-reset",{method:"POST",params:s,body:r}).then(this.authResponse.bind(this))},n}(A),et=function(i){function n(){return i!==null&&i.apply(this,arguments)||this}return h(n,i),n.prototype.decode=function(t){return new N(t)},n.prototype.baseCrudPath=function(){return"/api/users"},n.prototype.authResponse=function(t){var e=this.decode((t==null?void 0:t.user)||{});return(t==null?void 0:t.token)&&(t==null?void 0:t.user)&&this.client.authStore.save(t.token,e),Object.assign({},t,{token:(t==null?void 0:t.token)||"",user:e})},n.prototype.listAuthMethods=function(t){return t===void 0&&(t={}),this.client.send(this.baseCrudPath()+"/auth-methods",{method:"GET",params:t}).then(function(e){return Object.assign({},e,{emailPassword:!!(e!=null&&e.emailPassword),authProviders:Array.isArray(e==null?void 0:e.authProviders)?e==null?void 0:e.authProviders:[]})})},n.prototype.authViaEmail=function(t,e,o,r){return o===void 0&&(o={}),r===void 0&&(r={}),o=Object.assign({email:t,password:e},o),this.client.send(this.baseCrudPath()+"/auth-via-email",{method:"POST",params:r,body:o,headers:{Authorization:""}}).then(this.authResponse.bind(this))},n.prototype.authViaOAuth2=function(t,e,o,r,s,a){return s===void 0&&(s={}),a===void 0&&(a={}),s=Object.assign({provider:t,code:e,codeVerifier:o,redirectUrl:r},s),this.client.send(this.baseCrudPath()+"/auth-via-oauth2",{method:"POST",params:a,body:s,headers:{Authorization:""}}).then(this.authResponse.bind(this))},n.prototype.refresh=function(t,e){return t===void 0&&(t={}),e===void 0&&(e={}),this.client.send(this.baseCrudPath()+"/refresh",{method:"POST",params:e,body:t}).then(this.authResponse.bind(this))},n.prototype.requestPasswordReset=function(t,e,o){return e===void 0&&(e={}),o===void 0&&(o={}),e=Object.assign({email:t},e),this.client.send(this.baseCrudPath()+"/request-password-reset",{method:"POST",params:o,body:e}).then(function(){return!0})},n.prototype.confirmPasswordReset=function(t,e,o,r,s){return r===void 0&&(r={}),s===void 0&&(s={}),r=Object.assign({token:t,password:e,passwordConfirm:o},r),this.client.send(this.baseCrudPath()+"/confirm-password-reset",{method:"POST",params:s,body:r}).then(this.authResponse.bind(this))},n.prototype.requestVerification=function(t,e,o){return e===void 0&&(e={}),o===void 0&&(o={}),e=Object.assign({email:t},e),this.client.send(this.baseCrudPath()+"/request-verification",{method:"POST",params:o,body:e}).then(function(){return!0})},n.prototype.confirmVerification=function(t,e,o){return e===void 0&&(e={}),o===void 0&&(o={}),e=Object.assign({token:t},e),this.client.send(this.baseCrudPath()+"/confirm-verification",{method:"POST",params:o,body:e}).then(this.authResponse.bind(this))},n.prototype.requestEmailChange=function(t,e,o){return e===void 0&&(e={}),o===void 0&&(o={}),e=Object.assign({newEmail:t},e),this.client.send(this.baseCrudPath()+"/request-email-change",{method:"POST",params:o,body:e}).then(function(){return!0})},n.prototype.confirmEmailChange=function(t,e,o,r){return o===void 0&&(o={}),r===void 0&&(r={}),o=Object.assign({token:t,password:e},o),this.client.send(this.baseCrudPath()+"/confirm-email-change",{method:"POST",params:r,body:o}).then(this.authResponse.bind(this))},n}(A),nt=function(){function i(n){n===void 0&&(n={}),this.load(n||{})}return i.prototype.load=function(n){this.id=n.id!==void 0?n.id:"",this.name=n.name!==void 0?n.name:"",this.type=n.type!==void 0?n.type:"text",this.system=!!n.system,this.required=!!n.required,this.unique=!!n.unique,this.options=typeof n.options=="object"&&n.options!==null?n.options:{}},i}(),ot=function(i){function n(){return i!==null&&i.apply(this,arguments)||this}return h(n,i),n.prototype.load=function(t){i.prototype.load.call(this,t),this.name=typeof t.name=="string"?t.name:"",this.system=!!t.system,this.listRule=typeof t.listRule=="string"?t.listRule:null,this.viewRule=typeof t.viewRule=="string"?t.viewRule:null,this.createRule=typeof t.createRule=="string"?t.createRule:null,this.updateRule=typeof t.updateRule=="string"?t.updateRule:null,this.deleteRule=typeof t.deleteRule=="string"?t.deleteRule:null,t.schema=Array.isArray(t.schema)?t.schema:[],this.schema=[];for(var e=0,o=t.schema;e<o.length;e++){var r=o[e];this.schema.push(new nt(r))}},n}(C),it=function(i){function n(){return i!==null&&i.apply(this,arguments)||this}return h(n,i),n.prototype.decode=function(t){return new ot(t)},n.prototype.baseCrudPath=function(){return"/api/collections"},n}(A),rt=function(i){function n(){return i!==null&&i.apply(this,arguments)||this}return h(n,i),n.prototype.decode=function(t){return new x(t)},n.prototype.baseCrudPath=function(t){return"/api/collections/"+encodeURIComponent(t)+"/records"},n.prototype.getFileUrl=function(t,e,o){o===void 0&&(o={});var r=[];r.push(this.client.baseUrl.replace(/\/+$/gm,"")),r.push("api"),r.push("files"),r.push(t["@collectionId"]),r.push(t.id),r.push(e);var s=r.join("/");if(Object.keys(o).length){var a=new URLSearchParams(o);s+=(s.includes("?")?"&":"?")+a}return s},n}(function(i){function n(){return i!==null&&i.apply(this,arguments)||this}return h(n,i),n.prototype.getFullList=function(t,e,o){return e===void 0&&(e=100),o===void 0&&(o={}),this._getFullList(this.baseCrudPath(t),e,o)},n.prototype.getList=function(t,e,o,r){return e===void 0&&(e=1),o===void 0&&(o=30),r===void 0&&(r={}),this._getList(this.baseCrudPath(t),e,o,r)},n.prototype.getOne=function(t,e,o){return o===void 0&&(o={}),this._getOne(this.baseCrudPath(t),e,o)},n.prototype.create=function(t,e,o){return e===void 0&&(e={}),o===void 0&&(o={}),this._create(this.baseCrudPath(t),e,o)},n.prototype.update=function(t,e,o,r){return o===void 0&&(o={}),r===void 0&&(r={}),this._update(this.baseCrudPath(t),e,o,r)},n.prototype.delete=function(t,e,o,r){return o===void 0&&(o={}),r===void 0&&(r={}),this._delete(this.baseCrudPath(t),e,o,r)},n}(V)),I=function(i){function n(){return i!==null&&i.apply(this,arguments)||this}return h(n,i),n.prototype.load=function(t){i.prototype.load.call(this,t),this.url=typeof t.url=="string"?t.url:"",this.method=typeof t.method=="string"?t.method:"GET",this.status=typeof t.status=="number"?t.status:200,this.auth=typeof t.auth=="string"?t.auth:"guest",this.ip=typeof t.ip=="string"?t.ip:"",this.referer=typeof t.referer=="string"?t.referer:"",this.userAgent=typeof t.userAgent=="string"?t.userAgent:"",this.meta=typeof t.meta=="object"&&t.meta!==null?t.meta:{}},n}(C),st=function(i){function n(){return i!==null&&i.apply(this,arguments)||this}return h(n,i),n.prototype.getRequestsList=function(t,e,o){return t===void 0&&(t=1),e===void 0&&(e=30),o===void 0&&(o={}),o=Object.assign({page:t,perPage:e},o),this.client.send("/api/logs/requests",{method:"GET",params:o}).then(function(r){var s=[];if(r!=null&&r.items){r.items=(r==null?void 0:r.items)||[];for(var a=0,l=r.items;a<l.length;a++){var d=l[a];s.push(new I(d))}}return new D((r==null?void 0:r.page)||1,(r==null?void 0:r.perPage)||0,(r==null?void 0:r.totalItems)||0,s)})},n.prototype.getRequest=function(t,e){return e===void 0&&(e={}),this.client.send("/api/logs/requests/"+encodeURIComponent(t),{method:"GET",params:e}).then(function(o){return new I(o)})},n.prototype.getRequestsStats=function(t){return t===void 0&&(t={}),this.client.send("/api/logs/requests/stats",{method:"GET",params:t}).then(function(e){return e})},n}(P),at=function(i){function n(){var t=i!==null&&i.apply(this,arguments)||this;return t.clientId="",t.eventSource=null,t.subscriptions={},t}return h(n,i),n.prototype.subscribe=function(t,e){var o;return y(this,void 0,void 0,function(){return b(this,function(r){switch(r.label){case 0:if(!t)throw new Error("subscription must be set.");return this.subscriptions[t]&&((o=this.eventSource)===null||o===void 0||o.removeEventListener(t,this.subscriptions[t])),this.subscriptions[t]=function(s){var a,l=s;try{a=JSON.parse(l==null?void 0:l.data)}catch{}e(a||{})},this.eventSource?[3,1]:(this.connect(),[3,3]);case 1:return this.clientId?[4,this.submitSubscriptions()]:[3,3];case 2:r.sent(),r.label=3;case 3:return[2]}})})},n.prototype.unsubscribe=function(t){var e;return y(this,void 0,void 0,function(){return b(this,function(o){switch(o.label){case 0:if(t){if(!this.subscriptions[t])return[2];(e=this.eventSource)===null||e===void 0||e.removeEventListener(t,this.subscriptions[t]),delete this.subscriptions[t]}else this.removeSubscriptionListeners(),this.subscriptions={};return this.clientId?[4,this.submitSubscriptions()]:[3,2];case 1:o.sent(),o.label=2;case 2:return Object.keys(this.subscriptions).length||this.disconnect(),[2]}})})},n.prototype.submitSubscriptions=function(){return y(this,void 0,void 0,function(){return b(this,function(t){return this.addSubscriptionListeners(),[2,this.client.send("/api/realtime",{method:"POST",body:{clientId:this.clientId,subscriptions:Object.keys(this.subscriptions)}}).then(function(){return!0})]})})},n.prototype.addSubscriptionListeners=function(){if(this.eventSource)for(var t in this.removeSubscriptionListeners(),this.subscriptions)this.eventSource.addEventListener(t,this.subscriptions[t])},n.prototype.removeSubscriptionListeners=function(){if(this.eventSource)for(var t in this.subscriptions)this.eventSource.removeEventListener(t,this.subscriptions[t])},n.prototype.connectHandler=function(t){var e=t;this.clientId=e==null?void 0:e.lastEventId,this.submitSubscriptions()},n.prototype.connect=function(){var t=this;this.disconnect(),this.eventSource=new EventSource(this.client.buildUrl("/api/realtime")),this.eventSource.addEventListener("PB_CONNECT",function(e){return t.connectHandler(e)})},n.prototype.disconnect=function(){var t,e,o=this;this.removeSubscriptionListeners(),(t=this.eventSource)===null||t===void 0||t.removeEventListener("PB_CONNECT",function(r){return o.connectHandler(r)}),(e=this.eventSource)===null||e===void 0||e.close(),this.eventSource=null,this.clientId=""},n}(P),ut=function(){function i(n,t,e){n===void 0&&(n="/"),t===void 0&&(t="en-US"),this.cancelControllers={},this.baseUrl=n,this.lang=t,this.authStore=e||new X,this.admins=new tt(this),this.users=new et(this),this.records=new rt(this),this.collections=new it(this),this.logs=new st(this),this.settings=new Z(this),this.realtime=new at(this)}return Object.defineProperty(i.prototype,"AuthStore",{get:function(){return this.authStore},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"Settings",{get:function(){return this.settings},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"Admins",{get:function(){return this.admins},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"Users",{get:function(){return this.users},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"Collections",{get:function(){return this.collections},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"Records",{get:function(){return this.records},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"Logs",{get:function(){return this.logs},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"Realtime",{get:function(){return this.realtime},enumerable:!1,configurable:!0}),i.prototype.cancelRequest=function(n){return this.cancelControllers[n]&&(this.cancelControllers[n].abort(),delete this.cancelControllers[n]),this},i.prototype.cancelAllRequests=function(){for(var n in this.cancelControllers)this.cancelControllers[n].abort();return this.cancelControllers={},this},i.prototype.send=function(n,t){var e,o,r,s,a,l,d,u,p;return y(this,void 0,void 0,function(){var c,g,R,j,m,L,F=this;return b(this,function(dt){return(c=Object.assign({method:"GET"},t)).body&&c.body.constructor.name!=="FormData"&&(typeof c.body!="string"&&(c.body=JSON.stringify(c.body)),((e=c==null?void 0:c.headers)===null||e===void 0?void 0:e["Content-Type"])===void 0&&(c.headers=Object.assign({},c.headers,{"Content-Type":"application/json"}))),((o=c==null?void 0:c.headers)===null||o===void 0?void 0:o["Accept-Language"])===void 0&&(c.headers=Object.assign({},c.headers,{"Accept-Language":this.lang})),((r=this.authStore)===null||r===void 0?void 0:r.token)&&((s=c==null?void 0:c.headers)===null||s===void 0?void 0:s.Authorization)===void 0&&(g="Admin",((a=this.authStore.model)===null||a===void 0?void 0:a.verified)!==void 0&&(g="User"),c.headers=Object.assign({},c.headers,{Authorization:g+" "+this.authStore.token})),((l=c.params)===null||l===void 0?void 0:l.$autoCancel)!==!1&&(R=((d=c.params)===null||d===void 0?void 0:d.$cancelKey)||(c.method||"GET")+n,this.cancelRequest(R),j=new AbortController,this.cancelControllers[R]=j,c.signal=j.signal),(u=c.params)===null||u===void 0||delete u.$autoCancel,(p=c.params)===null||p===void 0||delete p.$cancelKey,m=this.buildUrl(n),c.params!==void 0&&((L=this.serializeQueryParams(c.params))&&(m+=(m.includes("?")?"&":"?")+L),delete c.params),this.beforeSend&&(c=Object.assign({},this.beforeSend(m,c))),[2,fetch(m,c).then(function(f){return y(F,void 0,void 0,function(){var v;return b(this,function(w){switch(w.label){case 0:v={},w.label=1;case 1:return w.trys.push([1,3,,4]),[4,f.json()];case 2:return v=w.sent(),[3,4];case 3:return w.sent(),[3,4];case 4:if(this.afterSend&&(v=this.afterSend(f,v)),f.status>=400)throw new E({url:f.url,status:f.status,data:v});return[2,v]}})})}).catch(function(f){throw f instanceof E?f:new E(f)})]})})},i.prototype.buildUrl=function(n){var t=this.baseUrl+(this.baseUrl.endsWith("/")?"":"/");return n&&(t+=n.startsWith("/")?n.substring(1):n),t},i.prototype.serializeQueryParams=function(n){var t=[];for(var e in n)if(n[e]!==null){var o=n[e],r=encodeURIComponent(e);if(Array.isArray(o))for(var s=0,a=o;s<a.length;s++){var l=a[s];t.push(r+"="+encodeURIComponent(l))}else o instanceof Date?t.push(r+"="+encodeURIComponent(o.toISOString())):typeof o!==null&&typeof o=="object"?t.push(r+"="+encodeURIComponent(JSON.stringify(o))):t.push(r+"="+encodeURIComponent(o))}return t.join("&")},i}();const ct={baseURL:"http://localhost:8090/",timeout:O.TIMEOUT,withCredentials:!0},M=new ut(ct.baseURL,"en-US");M.beforeSend=function(i,n){return n.headers.noLoading||$(),n};M.afterSend=function(i,n){const t=z();return Q(),n.code==O.OVERDUE?(k.error(n.msg),t.setToken(""),B.replace({path:"/login"}),Promise.reject(n)):n.code&&n.code!==O.SUCCESS?(k.error(n.message),Promise.reject(n)):n};const lt=i=>{let n;typeof i=="string"?n=i.toUpperCase():i instanceof Error&&(n=i.message),k.error(n)},pt=async i=>{try{return[await i(),null]}catch(n){return lt(n),[null,n]}};export{M as c,pt as t};
