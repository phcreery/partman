import{J as ce,E as ue,a as ie,s as X,o as J,K as de,r as T,d as V,b as m,c as r,e as k,t as d,L as z,B as b,w as f,F as U,M as Z,f as y,N as me,g as A,u as o,O as he,_ as fe,j as I,D as j,P as _,Q as ge,R as pe,I as be,S as ve,U as ye,V as we,W as L,X as Pe,Y as Se,Z as Ce,$ as ke}from"./index-0dd33b3d.js";import{n as Te,f as Y,a as M}from"./util-29963aac.js";const ea=(e,i,s,l="warning")=>new Promise((t,h)=>{ce.confirm(`${s}?`,"Are you sure?",{confirmButtonText:"Yes",cancelButtonText:"Cancel",type:l,draggable:!0}).then(async()=>{if(!await e(i))return h(!1);ue({type:"success",message:`${s} success!`}),t(!0)})});var ee="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAAAzCAMAAAA3r39rAAABEVBMVEUAAADb29va2trY2Njj4+PX19fZ2dng4ODf39/X19fj4+Py8vLk5OTt7e3V1dX09PT29vbZ2dn39/fY2Nj29vbb29v29vb29vb19fX29vbV1dX39/f29vb29vb19fXc3NzZ2dnd3d3e3t7h4eH19fX19fXZ2dn19fX39/fb29vb29vW1tb19fXT09P29vbf39/29vb19fXU1NTn5+fc3NzR0dH29vb19fX19fX29vbT09P39/f19fX39/ff39/39/fX19f19fXr6+vo6OjZ2dnn5+fb29vj4+Pd3d319fXm5ubm5ubj4+PY2Nja2tr39/fk5OT6+vr09PTm5ub39/f8/Pzx8fHi4uLp6enr6+vt7e37h5dsAAAAUXRSTlMAQpJ0ChanzshV+g7jBMAS47ONcNMd++jew4heMx7LwJ5HI/j387y3rKx3XFNPSeSabWswKyjt2b2ikYWBc108mZZsaT339evZsKycgX5QGL+U+rOeAAAC3UlEQVRYw+WV13qiQBiGiaIbJaAgFgTsvZds7DG9l3UEBnP/F7IIDyYmgDB7uO8R4Mc7/8z8I5gdhabfgfMC5pHfvnrOZ0uu7vvt0TfN9vNHtuSvqLQnYzxNneNOAfy8ko679xEv2QHpHCGvqRfCrQ8fZF/xg6FGZYC79DUpN9MJvFJNd8a3is9VUxR8lZCb3BGdc7mBhRydP5waBulTzCWn9frw4KhB+ghzzQ0dLBxowAs6hHngjc7FERraHtK5IyKx7BWBeYK4zjYitg14TW9/9Gj001e4XfkVXwDzTGBKN0nL+kIU5W+3Qyb5uMNa53exdjtGUSHcaqSLu+7xr0+Og7Zdmw/uBbt3FwErYbD4AZQdQIH1U7t+hspXPopBa2EYyKsdsqx0G9bCxokif02CsLPQzEnw2Vr4vNYD7oUm8Im07IYndbWHa6FasVzEYXYjowmV7rR9c/SNm/a0CxAqNIzFh+MfPBSVFYLQVP5EKw9ZaDaH81NnIQK2wlwRrNCExZyVkEjfowrv04SFEI+doApPYriNUP7PhAN04cBKGPGjCy2+bYTQz4ZRdzn8py8Qe7bOrMaNbteowvXtiKvNOqZT5BmuDCSwRheq2utljuHF7V4se1Gg8Q9CRRdqRHtLHGtx2pUhhIqMJoSa0JBwLWycMHQS+EAUyhuo6AKNxBjT52s4obqSNfSUcfU5gH4jf8N4Iq0hkCRgEMUuk6ZQ2kBVAZ5RVLjRfEaNyUtsyET1SW9vVQjXnoFwY7oTUWaonRC+miztRvMuVLcLuKWUrPL6icHFDsMm9EkDFCT9vQTLdETzSJPikp/X2JKESImtzfmlSO7/NwitBTOpZlJl4IFyKlOdMIuWEMGsIN+FVn/Wq1W5DJuKJs/KpcRnU5kkSuWzZDTFZrhqrTfrt4R3EnOAxAkiIgodfjFnepPHcSbDjlJb+VaSGrFsZvw4uWTmC74jiBGCwL/b/gIpvWL/TS00iAAAAABJRU5ErkJggg==";const Ae=(e,i={},s=!0,l)=>{const t=ie({tableData:[],pageable:{pageNum:1,pageSize:25,total:0},searchParam:{},searchInitParam:{},totalParam:{}}),h=X({get:()=>({page:t.pageable.pageNum,perPage:t.pageable.pageSize}),set:c=>{}});J(()=>{n()});const g=async()=>{try{Te(t.totalParam,i,s?h.value:{});let{data:c}=await e(t.totalParam);l&&(c=l(c)),t.tableData=s?c.datalist:c;const{pageNum:P,pageSize:B,total:R}=c;s&&w({pageNum:P,pageSize:B,total:R})}catch{}},v=()=>{t.totalParam={};let c={};for(let P in t.searchParam)(t.searchParam[P]||t.searchParam[P]===!1||t.searchParam[P]===0)&&(c[P]=t.searchParam[P]);Object.assign(t.totalParam,{filter:c},s?h.value:{})},w=c=>{Object.assign(t.pageable,c)},x=()=>{t.pageable.pageNum=1,v(),g()},n=()=>{t.pageable.pageNum=1,t.searchParam={},Object.keys(t.searchInitParam).forEach(c=>{t.searchParam[c]=t.searchInitParam[c]}),v(),g()},C=c=>{t.pageable.pageNum=1,t.pageable.pageSize=c,g()},p=c=>{t.pageable.pageNum=c,g()};return{...de(t),getTableList:g,search:x,reset:n,handleSizeChange:C,handleCurrentChange:p}},Ve=()=>{const e=T(!1),i=T([]),s=X(()=>{let h=[];return i.value.forEach(g=>{h.push(g.id)}),h});return{isSelected:e,selectedList:i,selectedListIds:s,selectionChange:h=>{h.length===0?e.value=!1:e.value=!0,i.value=h},getRowKeys:h=>h.id}},xe=V({name:"searchFormItem"}),Ne=V({...xe,props:{item:null,searchParam:null},setup(e){const i=s=>s.searchInitParam==null||s.searchInitParam==null;return(s,l)=>{const t=m("el-input"),h=m("el-option"),g=m("el-select"),v=m("el-tree-select"),w=m("el-date-picker"),x=m("el-time-picker");return r(),k(U,null,[e.item.searchType==null||e.item.searchType=="text"?(r(),d(t,z({key:0,modelValue:e.searchParam[e.item.prop],"onUpdate:modelValue":l[0]||(l[0]=n=>e.searchParam[e.item.prop]=n)},e.item.searchProps,{placeholder:"Search term",clearable:i(e.item)}),null,16,["modelValue","clearable"])):b("",!0),e.item.searchType=="select"||e.item.searchType=="multipleSelect"?(r(),d(g,z({key:1,modelValue:e.searchParam[e.item.prop],"onUpdate:modelValue":l[1]||(l[1]=n=>e.searchParam[e.item.prop]=n)},e.item.searchProps,{multiple:e.item.searchType=="multipleSelect",placeholder:"Select",clearable:i(e.item)}),{default:f(()=>[(r(!0),k(U,null,Z(e.item.enum,n=>{var C,p,c,P,B,R;return r(),d(h,{key:(p=n[(C=e.item.searchProps)==null?void 0:C.value])!=null?p:n.value,label:(P=n[(c=e.item.searchProps)==null?void 0:c.label])!=null?P:n.label,value:(R=n[(B=e.item.searchProps)==null?void 0:B.value])!=null?R:n.value,disabled:n.disabled},null,8,["label","value","disabled"])}),128))]),_:1},16,["modelValue","multiple","clearable"])):b("",!0),e.item.searchType=="treeSelect"||e.item.searchType=="multipleTreeSelect"?(r(),d(v,z({key:2,modelValue:e.searchParam[e.item.prop],"onUpdate:modelValue":l[2]||(l[2]=n=>e.searchParam[e.item.prop]=n)},e.item.searchProps,{multiple:e.item.searchType=="multipleTreeSelect",data:e.item.enumTree,clearable:i(e.item)}),null,16,["modelValue","multiple","data","clearable"])):b("",!0),e.item.searchType=="date"?(r(),d(w,z({key:3,modelValue:e.searchParam[e.item.prop],"onUpdate:modelValue":l[3]||(l[3]=n=>e.searchParam[e.item.prop]=n)},e.item.searchProps,{"value-format":"YYYY-MM-DD",type:"date",placeholder:"Please select the date",clearable:i(e.item)}),null,16,["modelValue","clearable"])):b("",!0),e.item.searchType=="timerange"?(r(),d(x,z({key:4,modelValue:e.searchParam[e.item.prop],"onUpdate:modelValue":l[4]||(l[4]=n=>e.searchParam[e.item.prop]=n)},e.item.searchProps,{"is-range":"","value-format":"HH:mm:ss","range-separator":"to","start-placeholder":"Starting time","end-placeholder":"End Time",clearable:i(e.item)}),null,16,["modelValue","clearable"])):b("",!0),e.item.searchType=="daterange"?(r(),d(w,z({key:5,modelValue:e.searchParam[e.item.prop],"onUpdate:modelValue":l[5]||(l[5]=n=>e.searchParam[e.item.prop]=n)},e.item.searchProps,{type:"daterange","value-format":"YYYY-MM-DD","range-separator":"to","start-placeholder":"Starting time","end-placeholder":"End Time",clearable:i(e.item)}),null,16,["modelValue","clearable"])):b("",!0),e.item.searchType=="datetimerange"?(r(),d(w,z({key:6,modelValue:e.searchParam[e.item.prop],"onUpdate:modelValue":l[6]||(l[6]=n=>e.searchParam[e.item.prop]=n)},e.item.searchProps,{type:"datetimerange","value-format":"YYYY-MM-DD HH:mm:ss","range-separator":"to","start-placeholder":"Starting time","end-placeholder":"End Time",clearable:i(e.item)}),null,16,["modelValue","clearable"])):b("",!0)],64)}}}),ze={key:0,class:"table-search"},Be={class:"search-operation"},Re=I("Search"),Ee=I("Reset"),Ue=V({name:"searchForm"}),Ie=V({...Ue,props:{columns:{default:()=>[]},searchParam:{default:{}},search:null,reset:null},setup(e){const i=e,s=T(4),l=T(1260);J(()=>{if(i.columns.length>=4){const g=["datetimerange","daterange"];g.includes(i.columns[3].searchType)&&(l.value=945,s.value=3),i.columns.slice(0,3).forEach(v=>{g.includes(v.searchType)&&(l.value=1155,s.value=3)})}});const t=T(!1),h=X(()=>t.value?i.columns:i.columns.slice(0,s.value));return(g,v)=>{const w=m("el-form-item"),x=m("el-form"),n=m("el-button"),C=m("el-icon");return e.columns.length?(r(),k("div",ze,[y(x,{ref:"formRef",model:e.searchParam,inline:!0,"label-width":"100px",style:me(`max-width: ${l.value}px`)},{default:f(()=>[(r(!0),k(U,null,Z(o(h),p=>(r(),d(w,{key:p.prop,label:`${p.label} :`},{default:f(()=>[y(Ne,{item:p,searchParam:e.searchParam},null,8,["item","searchParam"])]),_:2},1032,["label"]))),128))]),_:1},8,["model","style"]),A("div",Be,[y(n,{type:"primary",icon:o(he),onClick:e.search},{default:f(()=>[Re]),_:1},8,["icon","onClick"]),y(n,{icon:o(fe),onClick:e.reset},{default:f(()=>[Ee]),_:1},8,["icon","onClick"]),e.columns.length>s.value?(r(),d(n,{key:0,type:"primary",link:"",class:"search-isOpen",onClick:v[0]||(v[0]=p=>t.value=!t.value)},{default:f(()=>[I(j(t.value?"Simple":"Advanced")+" ",1),y(C,{class:"el-icon--right"},{default:f(()=>[(r(),d(_(t.value?o(ge):o(pe))))]),_:1})]),_:1})):b("",!0)])])):b("",!0)}}}),Ye=V({name:"pagination"}),je=V({...Ye,props:{pageable:null,handleSizeChange:null,handleCurrentChange:null},setup(e){return(i,s)=>{const l=m("el-pagination");return r(),d(l,{currentPage:e.pageable.pageNum,"page-size":e.pageable.pageSize,"page-sizes":[10,25,50,100,200],background:!0,layout:"total, sizes, prev, pager, next, jumper",total:e.pageable.total,onSizeChange:e.handleSizeChange,onCurrentChange:e.handleCurrentChange},null,8,["currentPage","page-size","total","onSizeChange","onCurrentChange"])}}}),De={class:"table-box"},Fe=A("div",{class:"table-empty"},[A("img",{src:ee,alt:"notData"}),A("div",null,"No data")],-1),He=V({name:"colSetting"}),Le=V({...He,props:{colSetting:null,tableRef:null},setup(e,{expose:i}){const s=e,l=T(!1),t=()=>{l.value=!0},h=()=>{be(()=>{s.tableRef.doLayout()})};return i({openColSetting:t}),(g,v)=>{const w=m("el-table-column"),x=m("el-switch"),n=m("el-table"),C=m("el-drawer");return r(),d(C,{title:"Column settings",modelValue:l.value,"onUpdate:modelValue":v[0]||(v[0]=p=>l.value=p),size:"400px"},{default:f(()=>[A("div",De,[y(n,{data:e.colSetting,border:!0},{empty:f(()=>[Fe]),default:f(()=>[y(w,{prop:"label",label:"Column",align:"center"}),y(w,{prop:"name",label:"Visibility",align:"center"},{default:f(p=>[y(x,{modelValue:p.row.isShow,"onUpdate:modelValue":c=>p.row.isShow=c,onClick:h},null,8,["modelValue","onUpdate:modelValue"])]),_:1})]),_:1},8,["data"])])]),_:1},8,["modelValue"])}}}),Me={class:"table-box"},Xe={class:"table-header"},Ze={class:"header-button-lf"},$e={key:0,class:"header-button-ri"},Ke=I(" Filter "),We={key:2},Oe={key:3},Qe=A("div",{class:"table-empty"},[A("img",{src:ee,alt:"notData"}),A("div",null,"No data")],-1),Ge=V({name:"component"}),qe=V({...Ge,props:{columns:{default:()=>[]},requestApi:null,dataCallback:null,pagination:{type:Boolean,default:!0},initParam:{default:{}},border:{type:Boolean,default:!0},stripe:{type:Boolean,default:!1},toolButton:{type:Boolean,default:!0},childrenName:{default:"children"}},setup(e,{expose:i}){const s=e,l=T(),t=T(!1),{selectionChange:h,getRowKeys:g,selectedListIds:v,isSelected:w}=Ve(),{tableData:x,pageable:n,searchParam:C,searchInitParam:p,getTableList:c,search:P,reset:B,handleSizeChange:R,handleCurrentChange:ae}=Ae(s.requestApi,s.initParam,s.pagination,s.dataCallback);ve(()=>s.initParam,()=>{c()},{deep:!0});const E=T();E.value=s.columns.map(u=>{var N;return{...u,isShow:(N=u.isShow)!=null?N:!0}}),E.value.forEach(async u=>{if(u.enumFunction&&typeof u.enumFunction=="function"){const{data:N}=await u.enumFunction();u.enum=N}if(u.enumTreeFunction&&typeof u.enumTreeFunction=="function"){const{data:N}=await u.enumTreeFunction();u.enumTree=N}});const D=E.value.filter(u=>u.search);D.forEach(u=>{u.searchInitParam!==void 0&&u.searchInitParam!==null&&(p.value[u.prop]=u.searchInitParam)});const $=T(),te=E.value.filter(u=>u.type!=="selection"&&u.type!=="index"&&u.type!=="expand"&&u.prop!=="operation"),le=()=>{$.value.openColSetting()},K=()=>{l.value.clearSelection(),c()};return i({searchParam:C,refresh:K,tableColumns:E}),(u,N)=>{const F=m("el-button"),ne=m("el-button-group"),H=m("el-table-column"),re=m("el-image"),oe=m("el-tag"),se=m("el-table");return r(),k("div",Me,[ye(y(Ie,{search:o(P),reset:o(B),searchParam:o(C),columns:o(D)},null,8,["search","reset","searchParam","columns"]),[[we,t.value]]),A("div",Xe,[A("div",Ze,[L(u.$slots,"tableHeader",{ids:o(v),isSelected:o(w)})]),e.toolButton?(r(),k("div",$e,[y(ne,null,{default:f(()=>[y(F,{icon:o(Pe),onClick:K},null,8,["icon"]),y(F,{icon:o(Se),onClick:le},null,8,["icon"]),o(D).length?(r(),d(F,{key:0,icon:o(Ce),onClick:N[0]||(N[0]=a=>t.value=!t.value)},{default:f(()=>[Ke]),_:1},8,["icon"])):b("",!0)]),_:1})])):b("",!0)]),y(se,{ref_key:"tableRef",ref:l,data:o(x),border:e.border,onSelectionChange:o(h),"row-key":o(g),stripe:e.stripe,"tree-props":{children:e.childrenName}},{empty:f(()=>[Qe]),default:f(()=>[(r(!0),k(U,null,Z(E.value,a=>{var W,O;return r(),k(U,{key:a},[a.type=="selection"||a.type=="index"?(r(),d(H,{key:0,type:a.type,"reserve-selection":a.type=="selection",label:a.label,width:a.width,"min-width":a.minWidth,fixed:a.fixed,align:"center"},null,8,["type","reserve-selection","label","width","min-width","fixed"])):b("",!0),a.type=="expand"?(r(),d(H,{key:1,type:a.type,label:a.label,width:a.width,"min-width":a.minWidth,fixed:a.fixed,align:(W=a.align)!=null?W:"center"},{default:f(S=>[L(u.$slots,a.type,{row:S.row})]),_:2},1032,["type","label","width","min-width","fixed","align"])):b("",!0),!a.type&&a.prop&&a.isShow?(r(),d(H,{key:2,prop:a.prop,label:a.label,width:a.width,"min-width":a.minWidth,sortable:a.sortable,"show-overflow-tooltip":a.prop!=="action",resizable:!0,fixed:a.fixed,align:(O=a.align)!=null?O:"center"},ke({default:f(S=>[L(u.$slots,a.prop,{row:S.row},()=>{var Q,G;return[a.image?(r(),d(re,{key:0,src:S.row[a.prop],"preview-src-list":[S.row[a.prop]],fit:"cover",class:"table-image","preview-teleported":""},null,8,["src","preview-src-list"])):a.tag?(r(),d(oe,{key:1,type:o(Y)(S.row[a.prop],a.enum,a.searchProps,"tag")},{default:f(()=>{var q;return[I(j((q=a.enum)!=null&&q.length?o(Y)(S.row[a.prop],a.enum,a.searchProps):o(M)(S.row[a.prop])),1)]}),_:2},1032,["type"])):typeof a.renderText=="function"?(r(),k("span",We,j((Q=a.enum)!=null&&Q.length?o(Y)(a.renderText(S.row),a.enum,a.searchProps):o(M)(a.renderText(S.row))),1)):(r(),k("span",Oe,j((G=a.enum)!=null&&G.length?o(Y)(S.row[a.prop],a.enum,a.searchProps):o(M)(S.row[a.prop])),1))]})]),_:2},[a.renderHeader?{name:"header",fn:f(()=>[(r(),d(_(a.renderHeader),{row:a},null,8,["row"]))])}:void 0]),1032,["prop","label","width","min-width","sortable","show-overflow-tooltip","fixed","align"])):b("",!0)],64)}),128))]),_:3},8,["data","border","onSelectionChange","row-key","stripe","tree-props"]),e.pagination?(r(),d(je,{key:0,pageable:o(n),handleSizeChange:o(R),handleCurrentChange:o(ae)},null,8,["pageable","handleSizeChange","handleCurrentChange"])):b("",!0),e.toolButton?(r(),d(Le,{key:1,ref_key:"colRef",ref:$,tableRef:l.value,colSetting:o(te)},null,8,["tableRef","colSetting"])):b("",!0)])}}});var aa=qe;export{aa as P,ea as u};
